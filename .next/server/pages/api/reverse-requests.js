"use strict";(()=>{var exports={};exports.id="pages/api/reverse-requests",exports.ids=["pages/api/reverse-requests"],exports.modules={"@prisma/client/edge":c=>{c.exports=require("@prisma/client/edge")},"next/dist/compiled/next-server/pages-api.runtime.dev.js":c=>{c.exports=require("next/dist/compiled/next-server/pages-api.runtime.dev.js")},"@prisma/extension-accelerate":c=>{c.exports=import("@prisma/extension-accelerate")},"(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freverse-requests&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Creverse-requests.ts&middlewareConfigBase64=e30%3D!":(module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ "(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ "(api)/./node_modules/next/dist/server/future/route-kind.js");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ "(api)/./node_modules/next/dist/build/templates/helpers.js");\n/* harmony import */ var _src_pages_api_reverse_requests_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\reverse-requests.ts */ "(api)/./src/pages/api/reverse-requests.ts");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_src_pages_api_reverse_requests_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_src_pages_api_reverse_requests_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_reverse_requests_ts__WEBPACK_IMPORTED_MODULE_3__, "default"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_reverse_requests_ts__WEBPACK_IMPORTED_MODULE_3__, "config");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: "/api/reverse-requests",\n        pathname: "/api/reverse-requests",\n        // The following aren\'t used in production.\n        bundlePath: "",\n        filename: ""\n    },\n    userland: _src_pages_api_reverse_requests_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnJldmVyc2UtcmVxdWVzdHMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1Q3JldmVyc2UtcmVxdWVzdHMudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDbUU7QUFDbkU7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLCtEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQywrREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0LXBhZ2VzLWNoYWtyYS8/N2VhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vc3JjXFxcXHBhZ2VzXFxcXGFwaVxcXFxyZXZlcnNlLXJlcXVlc3RzLnRzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcmV2ZXJzZS1yZXF1ZXN0c1wiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL3JldmVyc2UtcmVxdWVzdHNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freverse-requests&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Creverse-requests.ts&middlewareConfigBase64=e30%3D!\n')},"(api)/./src/lib/enhanced-wallet.ts":(module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   adminWalletAdjustment: () => (/* binding */ adminWalletAdjustment),\n/* harmony export */   checkEnhancedWalletBalance: () => (/* binding */ checkEnhancedWalletBalance),\n/* harmony export */   checkWalletBalance: () => (/* binding */ checkWalletBalance),\n/* harmony export */   creditToWallet: () => (/* binding */ creditToWallet),\n/* harmony export */   debugWalletConsistency: () => (/* binding */ debugWalletConsistency),\n/* harmony export */   deductFromWallet: () => (/* binding */ deductFromWallet),\n/* harmony export */   getOrCreateWallet: () => (/* binding */ getOrCreateWallet),\n/* harmony export */   getWalletSummary: () => (/* binding */ getWalletSummary),\n/* harmony export */   getWalletTransactions: () => (/* binding */ getWalletTransactions),\n/* harmony export */   processReturnCourierCost: () => (/* binding */ processReturnCourierCost),\n/* harmony export */   refundToWallet: () => (/* binding */ refundToWallet)\n/* harmony export */ });\n/* harmony import */ var _prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./prisma */ "(api)/./src/lib/prisma.ts");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_prisma__WEBPACK_IMPORTED_MODULE_0__]);\n_prisma__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// Enhanced Wallet Management Service\n// Unified wallet system that handles balance checks, deductions, and transaction logging\n// Fixes the wallet balance mismatch issue between display and shipment creation\n\n// Get or create wallet for a user\nasync function getOrCreateWallet(userId) {\n    try {\n        let wallet = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.wallet.findUnique({\n            where: {\n                userId\n            }\n        });\n        if (!wallet) {\n            console.log(`Creating new wallet for user: ${userId}`);\n            wallet = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.wallet.create({\n                data: {\n                    userId,\n                    balance: 0,\n                    totalEarned: 0,\n                    totalSpent: 0,\n                    lastRecharge: null\n                }\n            });\n        }\n        return {\n            userId: wallet.userId,\n            balance: wallet.balance,\n            totalEarned: wallet.totalEarned,\n            totalSpent: wallet.totalSpent,\n            lastRecharge: wallet.lastRecharge,\n            createdAt: wallet.createdAt,\n            updatedAt: wallet.updatedAt\n        };\n    } catch (error) {\n        console.error("Error getting or creating wallet:", error);\n        throw new Error(`Failed to get or create wallet: ${error instanceof Error ? error.message : "Unknown error"}`);\n    }\n}\n// Check wallet balance with detailed information\nasync function checkWalletBalance(userId, requiredAmount) {\n    try {\n        console.log(`Checking wallet balance for user: ${userId}, required: ₹${requiredAmount}`);\n        const wallet = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.wallet.findUnique({\n            where: {\n                userId\n            }\n        });\n        if (!wallet) {\n            console.log(`No wallet found for user: ${userId}`);\n            return {\n                sufficient: false,\n                currentBalance: 0,\n                shortfall: requiredAmount,\n                walletExists: false\n            };\n        }\n        const sufficient = wallet.balance >= requiredAmount;\n        const shortfall = sufficient ? undefined : requiredAmount - wallet.balance;\n        console.log(`Wallet check result - Balance: ₹${wallet.balance}, Required: ₹${requiredAmount}, Sufficient: ${sufficient}`);\n        return {\n            sufficient,\n            currentBalance: wallet.balance,\n            shortfall,\n            walletExists: true\n        };\n    } catch (error) {\n        console.error("Error checking wallet balance:", error);\n        return {\n            sufficient: false,\n            currentBalance: 0,\n            shortfall: requiredAmount,\n            walletExists: false\n        };\n    }\n}\n// Deduct amount from wallet with comprehensive logging\nasync function deductFromWallet(userId, amount, description, referenceId) {\n    try {\n        console.log(`Attempting to deduct ₹${amount} from wallet for user: ${userId}`);\n        console.log(`Description: ${description}`);\n        console.log(`Reference ID: ${referenceId || "None"}`);\n        // Check balance first\n        const balanceCheck = await checkWalletBalance(userId, amount);\n        if (!balanceCheck.sufficient) {\n            const error = `Insufficient wallet balance. Required: ₹${amount}, Available: ₹${balanceCheck.currentBalance}`;\n            console.error(error);\n            return {\n                success: false,\n                error,\n                details: {\n                    requiredAmount: amount,\n                    availableBalance: balanceCheck.currentBalance,\n                    shortfall: balanceCheck.shortfall,\n                    walletExists: balanceCheck.walletExists\n                }\n            };\n        }\n        // Perform deduction in a transaction\n        const result = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n            // Update wallet balance\n            const updatedWallet = await tx.wallet.update({\n                where: {\n                    userId\n                },\n                data: {\n                    balance: {\n                        decrement: amount\n                    },\n                    totalSpent: {\n                        increment: amount\n                    }\n                }\n            });\n            console.log(`Wallet updated - New balance: ₹${updatedWallet.balance}`);\n            // Log the transaction\n            const transaction = await tx.walletTransaction.create({\n                data: {\n                    userId,\n                    type: "DEBIT",\n                    amount,\n                    description,\n                    balanceAfter: updatedWallet.balance,\n                    status: "COMPLETED",\n                    purchaseOrderId: referenceId\n                }\n            });\n            console.log(`Transaction logged with ID: ${transaction.id}`);\n            return {\n                newBalance: updatedWallet.balance,\n                transactionId: transaction.id\n            };\n        });\n        return {\n            success: true,\n            newBalance: result.newBalance,\n            transactionId: result.transactionId,\n            details: {\n                deductedAmount: amount,\n                previousBalance: balanceCheck.currentBalance,\n                newBalance: result.newBalance\n            }\n        };\n    } catch (error) {\n        console.error("Error deducting from wallet:", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : "Wallet deduction failed",\n            details: {\n                originalError: error\n            }\n        };\n    }\n}\n// Credit amount to wallet (for recharges)\nasync function creditToWallet(userId, amount, description = "Wallet Recharge", referenceId) {\n    try {\n        console.log(`Crediting ₹${amount} to wallet for user: ${userId}`);\n        console.log(`Description: ${description}`);\n        // Ensure wallet exists\n        await getOrCreateWallet(userId);\n        const result = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n            // Update wallet balance and last recharge date\n            const updatedWallet = await tx.wallet.update({\n                where: {\n                    userId\n                },\n                data: {\n                    balance: {\n                        increment: amount\n                    },\n                    totalEarned: {\n                        increment: amount\n                    },\n                    lastRecharge: new Date()\n                }\n            });\n            // Log the credit transaction\n            const transaction = await tx.walletTransaction.create({\n                data: {\n                    userId,\n                    type: "CREDIT",\n                    amount,\n                    description,\n                    balanceAfter: updatedWallet.balance,\n                    status: "COMPLETED",\n                    purchaseOrderId: referenceId\n                }\n            });\n            return {\n                newBalance: updatedWallet.balance,\n                transactionId: transaction.id\n            };\n        });\n        console.log(`Credit successful - New balance: ₹${result.newBalance}`);\n        return {\n            success: true,\n            newBalance: result.newBalance,\n            transactionId: result.transactionId,\n            details: {\n                creditedAmount: amount,\n                newBalance: result.newBalance\n            }\n        };\n    } catch (error) {\n        console.error("Error crediting to wallet:", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : "Wallet credit failed",\n            details: {\n                originalError: error\n            }\n        };\n    }\n}\n// Refund amount to wallet (in case of API failure)\nasync function refundToWallet(userId, amount, description, referenceId) {\n    try {\n        console.log(`Refunding ₹${amount} to wallet for user: ${userId}`);\n        console.log(`Description: ${description}`);\n        const result = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.$transaction(async (tx)=>{\n            // Update wallet balance\n            const updatedWallet = await tx.wallet.update({\n                where: {\n                    userId\n                },\n                data: {\n                    balance: {\n                        increment: amount\n                    },\n                    totalSpent: {\n                        decrement: amount\n                    }\n                }\n            });\n            // Log the refund transaction\n            const transaction = await tx.walletTransaction.create({\n                data: {\n                    userId,\n                    type: "CREDIT",\n                    amount,\n                    description: `REFUND: ${description}`,\n                    balanceAfter: updatedWallet.balance,\n                    status: "COMPLETED",\n                    purchaseOrderId: referenceId\n                }\n            });\n            return {\n                newBalance: updatedWallet.balance,\n                transactionId: transaction.id\n            };\n        });\n        console.log(`Refund successful - New balance: ₹${result.newBalance}`);\n        return {\n            success: true,\n            newBalance: result.newBalance,\n            transactionId: result.transactionId,\n            details: {\n                refundedAmount: amount,\n                newBalance: result.newBalance\n            }\n        };\n    } catch (error) {\n        console.error("Error refunding to wallet:", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : "Wallet refund failed",\n            details: {\n                originalError: error\n            }\n        };\n    }\n}\n// Get wallet transaction history\nasync function getWalletTransactions(userId, limit = 50, offset = 0) {\n    try {\n        const transactions = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.walletTransaction.findMany({\n            where: {\n                userId\n            },\n            orderBy: {\n                createdAt: "desc"\n            },\n            take: limit,\n            skip: offset\n        });\n        return transactions.map((t)=>({\n                id: t.id,\n                userId: t.userId,\n                type: t.type,\n                amount: t.amount,\n                description: t.description,\n                balanceAfter: t.balanceAfter,\n                status: t.status,\n                createdAt: t.createdAt,\n                purchaseOrderId: t.purchaseOrderId || undefined\n            }));\n    } catch (error) {\n        console.error("Error fetching wallet transactions:", error);\n        return [];\n    }\n}\n// Get wallet summary with detailed breakdown\nasync function getWalletSummary(userId) {\n    try {\n        const wallet = await getOrCreateWallet(userId);\n        const transactions = await getWalletTransactions(userId, 10);\n        // Calculate summary from transactions\n        const allTransactions = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.walletTransaction.findMany({\n            where: {\n                userId\n            },\n            select: {\n                type: true,\n                amount: true,\n                createdAt: true\n            }\n        });\n        const totalCredits = allTransactions.filter((t)=>t.type === "CREDIT").reduce((sum, t)=>sum + t.amount, 0);\n        const totalDebits = allTransactions.filter((t)=>t.type === "DEBIT").reduce((sum, t)=>sum + t.amount, 0);\n        const lastTransactionDate = allTransactions.length > 0 ? allTransactions.sort((a, b)=>b.createdAt.getTime() - a.createdAt.getTime())[0].createdAt : null;\n        return {\n            wallet,\n            recentTransactions: transactions,\n            summary: {\n                totalCredits,\n                totalDebits,\n                transactionCount: allTransactions.length,\n                lastTransactionDate\n            }\n        };\n    } catch (error) {\n        console.error("Error getting wallet summary:", error);\n        throw new Error(`Failed to get wallet summary: ${error instanceof Error ? error.message : "Unknown error"}`);\n    }\n}\n// Debug function to check wallet consistency\nasync function debugWalletConsistency(userId) {\n    try {\n        console.log(`=== WALLET DEBUG FOR USER: ${userId} ===`);\n        const wallet = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.wallet.findUnique({\n            where: {\n                userId\n            }\n        });\n        const transactions = await _prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.walletTransaction.findMany({\n            where: {\n                userId\n            },\n            orderBy: {\n                createdAt: "asc"\n            }\n        });\n        let calculatedBalance = 0;\n        const issues = [];\n        // Calculate balance from transactions\n        for (const transaction of transactions){\n            if (transaction.type === "CREDIT") {\n                calculatedBalance += transaction.amount;\n            } else {\n                calculatedBalance -= transaction.amount;\n            }\n        }\n        const lastTransaction = transactions.length > 0 ? transactions[transactions.length - 1] : null;\n        // Check consistency\n        const isConsistent = wallet ? Math.abs(wallet.balance - calculatedBalance) < 0.01 : calculatedBalance === 0;\n        if (!wallet) {\n            issues.push("Wallet record does not exist");\n        } else {\n            if (!isConsistent) {\n                issues.push(`Balance mismatch: Wallet shows ₹${wallet.balance}, calculated ₹${calculatedBalance}`);\n            }\n            if (lastTransaction && Math.abs(lastTransaction.balanceAfter - wallet.balance) > 0.01) {\n                issues.push(`Last transaction balance mismatch: Transaction shows ₹${lastTransaction.balanceAfter}, wallet shows ₹${wallet.balance}`);\n            }\n        }\n        console.log(`Wallet exists: ${!!wallet}`);\n        console.log(`Stored balance: ₹${wallet?.balance || 0}`);\n        console.log(`Calculated balance: ₹${calculatedBalance}`);\n        console.log(`Transaction count: ${transactions.length}`);\n        console.log(`Is consistent: ${isConsistent}`);\n        console.log(`Issues: ${issues.length > 0 ? issues.join(", ") : "None"}`);\n        return {\n            walletData: wallet ? {\n                userId: wallet.userId,\n                balance: wallet.balance,\n                totalEarned: wallet.totalEarned,\n                totalSpent: wallet.totalSpent,\n                lastRecharge: wallet.lastRecharge,\n                createdAt: wallet.createdAt,\n                updatedAt: wallet.updatedAt\n            } : null,\n            calculatedBalance,\n            transactionCount: transactions.length,\n            lastTransaction: lastTransaction ? {\n                id: lastTransaction.id,\n                userId: lastTransaction.userId,\n                type: lastTransaction.type,\n                amount: lastTransaction.amount,\n                description: lastTransaction.description,\n                balanceAfter: lastTransaction.balanceAfter,\n                status: lastTransaction.status,\n                createdAt: lastTransaction.createdAt,\n                purchaseOrderId: lastTransaction.purchaseOrderId || undefined\n            } : null,\n            isConsistent,\n            issues\n        };\n    } catch (error) {\n        console.error("Error debugging wallet consistency:", error);\n        throw error;\n    }\n}\n// Check enhanced wallet balance (alias for checkWalletBalance)\nasync function checkEnhancedWalletBalance(userId, requiredAmount) {\n    return checkWalletBalance(userId, requiredAmount);\n}\n// Process return courier cost\nasync function processReturnCourierCost(userId, amount, returnReason, costResponsibility, referenceId) {\n    try {\n        console.log(`Processing return courier cost for user: ${userId}`);\n        console.log(`Amount: ₹${amount}, Reason: ${returnReason}, Responsibility: ${costResponsibility}`);\n        // Determine who pays based on cost responsibility\n        if (costResponsibility === "BRAND") {\n            // Brand pays - no deduction from user wallet\n            return {\n                success: true,\n                details: {\n                    message: "Return cost covered by brand",\n                    costResponsibility,\n                    amount\n                }\n            };\n        } else if (costResponsibility === "SERVICE_CENTER") {\n            // Service center pays - deduct from their wallet\n            return await deductFromWallet(userId, amount, `Return courier cost - ${returnReason}`, referenceId);\n        } else {\n            // Customer pays - handle separately or return error\n            return {\n                success: false,\n                error: "Customer payment not handled through wallet system",\n                details: {\n                    costResponsibility,\n                    amount\n                }\n            };\n        }\n    } catch (error) {\n        console.error("Error processing return courier cost:", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : "Failed to process return courier cost",\n            details: {\n                originalError: error\n            }\n        };\n    }\n}\n// Admin wallet adjustment function\nasync function adminWalletAdjustment(userId, amount, type, description, adminId) {\n    try {\n        console.log(`Admin wallet adjustment for user: ${userId}`);\n        console.log(`Type: ${type}, Amount: ₹${amount}, Admin: ${adminId}`);\n        const adjustmentDescription = `ADMIN ADJUSTMENT by ${adminId}: ${description}`;\n        if (type === "CREDIT") {\n            return await creditToWallet(userId, amount, adjustmentDescription);\n        } else {\n            return await deductFromWallet(userId, amount, adjustmentDescription);\n        }\n    } catch (error) {\n        console.error("Error in admin wallet adjustment:", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : "Admin wallet adjustment failed",\n            details: {\n                originalError: error\n            }\n        };\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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OUYsUUFBUUMsR0FBRyxDQUFDLENBQUMsa0NBQWtDLEVBQUVMLE9BQU8sQ0FBQztRQUN6REksUUFBUUMsR0FBRyxDQUFDLENBQUMsTUFBTSxFQUFFb0MsS0FBSyxXQUFXLEVBQUVoQixPQUFPLFNBQVMsRUFBRXlFLFFBQVEsQ0FBQztRQUVsRSxNQUFNQyx3QkFBd0IsQ0FBQyxvQkFBb0IsRUFBRUQsUUFBUSxFQUFFLEVBQUV4RSxZQUFZLENBQUM7UUFFOUUsSUFBSWUsU0FBUyxVQUFVO1lBQ3JCLE9BQU8sTUFBTVUsZUFBZW5ELFFBQVF5QixRQUFRMEU7UUFDOUMsT0FBTztZQUNMLE9BQU8sTUFBTTNFLGlCQUFpQnhCLFFBQVF5QixRQUFRMEU7UUFDaEQ7SUFDRixFQUFFLE9BQU9yRixPQUFPO1FBQ2RWLFFBQVFVLEtBQUssQ0FBQyxxQ0FBcUNBO1FBQ25ELE9BQU87WUFDTGUsU0FBUztZQUNUZixPQUFPQSxpQkFBaUJDLFFBQVFELE1BQU1FLE9BQU8sR0FBRztZQUNoRGMsU0FBUztnQkFBRW9CLGVBQWVwQztZQUFNO1FBQ2xDO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHQtcGFnZXMtY2hha3JhLy4vc3JjL2xpYi9lbmhhbmNlZC13YWxsZXQudHM/MWY4MyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFbmhhbmNlZCBXYWxsZXQgTWFuYWdlbWVudCBTZXJ2aWNlXHJcbi8vIFVuaWZpZWQgd2FsbGV0IHN5c3RlbSB0aGF0IGhhbmRsZXMgYmFsYW5jZSBjaGVja3MsIGRlZHVjdGlvbnMsIGFuZCB0cmFuc2FjdGlvbiBsb2dnaW5nXHJcbi8vIEZpeGVzIHRoZSB3YWxsZXQgYmFsYW5jZSBtaXNtYXRjaCBpc3N1ZSBiZXR3ZWVuIGRpc3BsYXkgYW5kIHNoaXBtZW50IGNyZWF0aW9uXHJcblxyXG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuL3ByaXNtYSc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEVuaGFuY2VkV2FsbGV0QmFsYW5jZSB7XHJcbiAgdXNlcklkOiBzdHJpbmc7XHJcbiAgYmFsYW5jZTogbnVtYmVyO1xyXG4gIHRvdGFsRWFybmVkOiBudW1iZXI7XHJcbiAgdG90YWxTcGVudDogbnVtYmVyO1xyXG4gIGxhc3RSZWNoYXJnZTogRGF0ZSB8IG51bGw7XHJcbiAgY3JlYXRlZEF0OiBEYXRlO1xyXG4gIHVwZGF0ZWRBdDogRGF0ZTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFbmhhbmNlZFdhbGxldFRyYW5zYWN0aW9uIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHVzZXJJZDogc3RyaW5nO1xyXG4gIHR5cGU6ICdDUkVESVQnIHwgJ0RFQklUJztcclxuICBhbW91bnQ6IG51bWJlcjtcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xyXG4gIGJhbGFuY2VBZnRlcjogbnVtYmVyO1xyXG4gIHN0YXR1czogc3RyaW5nO1xyXG4gIGNyZWF0ZWRBdDogRGF0ZTtcclxuICBwdXJjaGFzZU9yZGVySWQ/OiBzdHJpbmc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2FsbGV0T3BlcmF0aW9uUmVzdWx0IHtcclxuICBzdWNjZXNzOiBib29sZWFuO1xyXG4gIG5ld0JhbGFuY2U/OiBudW1iZXI7XHJcbiAgdHJhbnNhY3Rpb25JZD86IHN0cmluZztcclxuICBlcnJvcj86IHN0cmluZztcclxuICBkZXRhaWxzPzogYW55O1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEJhbGFuY2VDaGVja1Jlc3VsdCB7XHJcbiAgc3VmZmljaWVudDogYm9vbGVhbjtcclxuICBjdXJyZW50QmFsYW5jZTogbnVtYmVyO1xyXG4gIHNob3J0ZmFsbD86IG51bWJlcjtcclxuICB3YWxsZXRFeGlzdHM6IGJvb2xlYW47XHJcbn1cclxuXHJcbi8vIEdldCBvciBjcmVhdGUgd2FsbGV0IGZvciBhIHVzZXJcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yQ3JlYXRlV2FsbGV0KHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxFbmhhbmNlZFdhbGxldEJhbGFuY2U+IHtcclxuICB0cnkge1xyXG4gICAgbGV0IHdhbGxldCA9IGF3YWl0IHByaXNtYS53YWxsZXQuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IHVzZXJJZCB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIXdhbGxldCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgQ3JlYXRpbmcgbmV3IHdhbGxldCBmb3IgdXNlcjogJHt1c2VySWR9YCk7XHJcbiAgICAgIHdhbGxldCA9IGF3YWl0IHByaXNtYS53YWxsZXQuY3JlYXRlKHtcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICBiYWxhbmNlOiAwLFxyXG4gICAgICAgICAgdG90YWxFYXJuZWQ6IDAsXHJcbiAgICAgICAgICB0b3RhbFNwZW50OiAwLFxyXG4gICAgICAgICAgbGFzdFJlY2hhcmdlOiBudWxsXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1c2VySWQ6IHdhbGxldC51c2VySWQsXHJcbiAgICAgIGJhbGFuY2U6IHdhbGxldC5iYWxhbmNlLFxyXG4gICAgICB0b3RhbEVhcm5lZDogd2FsbGV0LnRvdGFsRWFybmVkLFxyXG4gICAgICB0b3RhbFNwZW50OiB3YWxsZXQudG90YWxTcGVudCxcclxuICAgICAgbGFzdFJlY2hhcmdlOiB3YWxsZXQubGFzdFJlY2hhcmdlLFxyXG4gICAgICBjcmVhdGVkQXQ6IHdhbGxldC5jcmVhdGVkQXQsXHJcbiAgICAgIHVwZGF0ZWRBdDogd2FsbGV0LnVwZGF0ZWRBdFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBvciBjcmVhdGluZyB3YWxsZXQ6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gZ2V0IG9yIGNyZWF0ZSB3YWxsZXQ6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDaGVjayB3YWxsZXQgYmFsYW5jZSB3aXRoIGRldGFpbGVkIGluZm9ybWF0aW9uXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGVja1dhbGxldEJhbGFuY2UoXHJcbiAgdXNlcklkOiBzdHJpbmcsXHJcbiAgcmVxdWlyZWRBbW91bnQ6IG51bWJlclxyXG4pOiBQcm9taXNlPEJhbGFuY2VDaGVja1Jlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgQ2hlY2tpbmcgd2FsbGV0IGJhbGFuY2UgZm9yIHVzZXI6ICR7dXNlcklkfSwgcmVxdWlyZWQ6IOKCuSR7cmVxdWlyZWRBbW91bnR9YCk7XHJcbiAgICBcclxuICAgIGNvbnN0IHdhbGxldCA9IGF3YWl0IHByaXNtYS53YWxsZXQuZmluZFVuaXF1ZSh7XHJcbiAgICAgIHdoZXJlOiB7IHVzZXJJZCB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBpZiAoIXdhbGxldCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgTm8gd2FsbGV0IGZvdW5kIGZvciB1c2VyOiAke3VzZXJJZH1gKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWZmaWNpZW50OiBmYWxzZSxcclxuICAgICAgICBjdXJyZW50QmFsYW5jZTogMCxcclxuICAgICAgICBzaG9ydGZhbGw6IHJlcXVpcmVkQW1vdW50LFxyXG4gICAgICAgIHdhbGxldEV4aXN0czogZmFsc2VcclxuICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzdWZmaWNpZW50ID0gd2FsbGV0LmJhbGFuY2UgPj0gcmVxdWlyZWRBbW91bnQ7XHJcbiAgICBjb25zdCBzaG9ydGZhbGwgPSBzdWZmaWNpZW50ID8gdW5kZWZpbmVkIDogcmVxdWlyZWRBbW91bnQgLSB3YWxsZXQuYmFsYW5jZTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhgV2FsbGV0IGNoZWNrIHJlc3VsdCAtIEJhbGFuY2U6IOKCuSR7d2FsbGV0LmJhbGFuY2V9LCBSZXF1aXJlZDog4oK5JHtyZXF1aXJlZEFtb3VudH0sIFN1ZmZpY2llbnQ6ICR7c3VmZmljaWVudH1gKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWZmaWNpZW50LFxyXG4gICAgICBjdXJyZW50QmFsYW5jZTogd2FsbGV0LmJhbGFuY2UsXHJcbiAgICAgIHNob3J0ZmFsbCxcclxuICAgICAgd2FsbGV0RXhpc3RzOiB0cnVlXHJcbiAgICB9O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyB3YWxsZXQgYmFsYW5jZTonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWZmaWNpZW50OiBmYWxzZSxcclxuICAgICAgY3VycmVudEJhbGFuY2U6IDAsXHJcbiAgICAgIHNob3J0ZmFsbDogcmVxdWlyZWRBbW91bnQsXHJcbiAgICAgIHdhbGxldEV4aXN0czogZmFsc2VcclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyBEZWR1Y3QgYW1vdW50IGZyb20gd2FsbGV0IHdpdGggY29tcHJlaGVuc2l2ZSBsb2dnaW5nXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWR1Y3RGcm9tV2FsbGV0KFxyXG4gIHVzZXJJZDogc3RyaW5nLFxyXG4gIGFtb3VudDogbnVtYmVyLFxyXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmcsXHJcbiAgcmVmZXJlbmNlSWQ/OiBzdHJpbmdcclxuKTogUHJvbWlzZTxXYWxsZXRPcGVyYXRpb25SZXN1bHQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYEF0dGVtcHRpbmcgdG8gZGVkdWN0IOKCuSR7YW1vdW50fSBmcm9tIHdhbGxldCBmb3IgdXNlcjogJHt1c2VySWR9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgRGVzY3JpcHRpb246ICR7ZGVzY3JpcHRpb259YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgUmVmZXJlbmNlIElEOiAke3JlZmVyZW5jZUlkIHx8ICdOb25lJ31gKTtcclxuXHJcbiAgICAvLyBDaGVjayBiYWxhbmNlIGZpcnN0XHJcbiAgICBjb25zdCBiYWxhbmNlQ2hlY2sgPSBhd2FpdCBjaGVja1dhbGxldEJhbGFuY2UodXNlcklkLCBhbW91bnQpO1xyXG4gICAgXHJcbiAgICBpZiAoIWJhbGFuY2VDaGVjay5zdWZmaWNpZW50KSB7XHJcbiAgICAgIGNvbnN0IGVycm9yID0gYEluc3VmZmljaWVudCB3YWxsZXQgYmFsYW5jZS4gUmVxdWlyZWQ6IOKCuSR7YW1vdW50fSwgQXZhaWxhYmxlOiDigrkke2JhbGFuY2VDaGVjay5jdXJyZW50QmFsYW5jZX1gO1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcixcclxuICAgICAgICBkZXRhaWxzOiB7XHJcbiAgICAgICAgICByZXF1aXJlZEFtb3VudDogYW1vdW50LFxyXG4gICAgICAgICAgYXZhaWxhYmxlQmFsYW5jZTogYmFsYW5jZUNoZWNrLmN1cnJlbnRCYWxhbmNlLFxyXG4gICAgICAgICAgc2hvcnRmYWxsOiBiYWxhbmNlQ2hlY2suc2hvcnRmYWxsLFxyXG4gICAgICAgICAgd2FsbGV0RXhpc3RzOiBiYWxhbmNlQ2hlY2sud2FsbGV0RXhpc3RzXHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFBlcmZvcm0gZGVkdWN0aW9uIGluIGEgdHJhbnNhY3Rpb25cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XHJcbiAgICAgIC8vIFVwZGF0ZSB3YWxsZXQgYmFsYW5jZVxyXG4gICAgICBjb25zdCB1cGRhdGVkV2FsbGV0ID0gYXdhaXQgdHgud2FsbGV0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgYmFsYW5jZTogeyBkZWNyZW1lbnQ6IGFtb3VudCB9LFxyXG4gICAgICAgICAgdG90YWxTcGVudDogeyBpbmNyZW1lbnQ6IGFtb3VudCB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGNvbnNvbGUubG9nKGBXYWxsZXQgdXBkYXRlZCAtIE5ldyBiYWxhbmNlOiDigrkke3VwZGF0ZWRXYWxsZXQuYmFsYW5jZX1gKTtcclxuXHJcbiAgICAgIC8vIExvZyB0aGUgdHJhbnNhY3Rpb25cclxuICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBhd2FpdCB0eC53YWxsZXRUcmFuc2FjdGlvbi5jcmVhdGUoe1xyXG4gICAgICAgIGRhdGE6IHtcclxuICAgICAgICAgIHVzZXJJZCxcclxuICAgICAgICAgIHR5cGU6ICdERUJJVCcsXHJcbiAgICAgICAgICBhbW91bnQsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgICAgIGJhbGFuY2VBZnRlcjogdXBkYXRlZFdhbGxldC5iYWxhbmNlLFxyXG4gICAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcclxuICAgICAgICAgIHB1cmNoYXNlT3JkZXJJZDogcmVmZXJlbmNlSWRcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgY29uc29sZS5sb2coYFRyYW5zYWN0aW9uIGxvZ2dlZCB3aXRoIElEOiAke3RyYW5zYWN0aW9uLmlkfWApO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBuZXdCYWxhbmNlOiB1cGRhdGVkV2FsbGV0LmJhbGFuY2UsXHJcbiAgICAgICAgdHJhbnNhY3Rpb25JZDogdHJhbnNhY3Rpb24uaWRcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG5ld0JhbGFuY2U6IHJlc3VsdC5uZXdCYWxhbmNlLFxyXG4gICAgICB0cmFuc2FjdGlvbklkOiByZXN1bHQudHJhbnNhY3Rpb25JZCxcclxuICAgICAgZGV0YWlsczoge1xyXG4gICAgICAgIGRlZHVjdGVkQW1vdW50OiBhbW91bnQsXHJcbiAgICAgICAgcHJldmlvdXNCYWxhbmNlOiBiYWxhbmNlQ2hlY2suY3VycmVudEJhbGFuY2UsXHJcbiAgICAgICAgbmV3QmFsYW5jZTogcmVzdWx0Lm5ld0JhbGFuY2VcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlZHVjdGluZyBmcm9tIHdhbGxldDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1dhbGxldCBkZWR1Y3Rpb24gZmFpbGVkJyxcclxuICAgICAgZGV0YWlsczogeyBvcmlnaW5hbEVycm9yOiBlcnJvciB9XHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG5cclxuLy8gQ3JlZGl0IGFtb3VudCB0byB3YWxsZXQgKGZvciByZWNoYXJnZXMpXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVkaXRUb1dhbGxldChcclxuICB1c2VySWQ6IHN0cmluZyxcclxuICBhbW91bnQ6IG51bWJlcixcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nID0gJ1dhbGxldCBSZWNoYXJnZScsXHJcbiAgcmVmZXJlbmNlSWQ/OiBzdHJpbmdcclxuKTogUHJvbWlzZTxXYWxsZXRPcGVyYXRpb25SZXN1bHQ+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYENyZWRpdGluZyDigrkke2Ftb3VudH0gdG8gd2FsbGV0IGZvciB1c2VyOiAke3VzZXJJZH1gKTtcclxuICAgIGNvbnNvbGUubG9nKGBEZXNjcmlwdGlvbjogJHtkZXNjcmlwdGlvbn1gKTtcclxuXHJcbiAgICAvLyBFbnN1cmUgd2FsbGV0IGV4aXN0c1xyXG4gICAgYXdhaXQgZ2V0T3JDcmVhdGVXYWxsZXQodXNlcklkKTtcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBwcmlzbWEuJHRyYW5zYWN0aW9uKGFzeW5jICh0eCkgPT4ge1xyXG4gICAgICAvLyBVcGRhdGUgd2FsbGV0IGJhbGFuY2UgYW5kIGxhc3QgcmVjaGFyZ2UgZGF0ZVxyXG4gICAgICBjb25zdCB1cGRhdGVkV2FsbGV0ID0gYXdhaXQgdHgud2FsbGV0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgYmFsYW5jZTogeyBpbmNyZW1lbnQ6IGFtb3VudCB9LFxyXG4gICAgICAgICAgdG90YWxFYXJuZWQ6IHsgaW5jcmVtZW50OiBhbW91bnQgfSxcclxuICAgICAgICAgIGxhc3RSZWNoYXJnZTogbmV3IERhdGUoKVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBMb2cgdGhlIGNyZWRpdCB0cmFuc2FjdGlvblxyXG4gICAgICBjb25zdCB0cmFuc2FjdGlvbiA9IGF3YWl0IHR4LndhbGxldFRyYW5zYWN0aW9uLmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgdXNlcklkLFxyXG4gICAgICAgICAgdHlwZTogJ0NSRURJVCcsXHJcbiAgICAgICAgICBhbW91bnQsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbixcclxuICAgICAgICAgIGJhbGFuY2VBZnRlcjogdXBkYXRlZFdhbGxldC5iYWxhbmNlLFxyXG4gICAgICAgICAgc3RhdHVzOiAnQ09NUExFVEVEJyxcclxuICAgICAgICAgIHB1cmNoYXNlT3JkZXJJZDogcmVmZXJlbmNlSWRcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBuZXdCYWxhbmNlOiB1cGRhdGVkV2FsbGV0LmJhbGFuY2UsXHJcbiAgICAgICAgdHJhbnNhY3Rpb25JZDogdHJhbnNhY3Rpb24uaWRcclxuICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKGBDcmVkaXQgc3VjY2Vzc2Z1bCAtIE5ldyBiYWxhbmNlOiDigrkke3Jlc3VsdC5uZXdCYWxhbmNlfWApO1xyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIG5ld0JhbGFuY2U6IHJlc3VsdC5uZXdCYWxhbmNlLFxyXG4gICAgICB0cmFuc2FjdGlvbklkOiByZXN1bHQudHJhbnNhY3Rpb25JZCxcclxuICAgICAgZGV0YWlsczoge1xyXG4gICAgICAgIGNyZWRpdGVkQW1vdW50OiBhbW91bnQsXHJcbiAgICAgICAgbmV3QmFsYW5jZTogcmVzdWx0Lm5ld0JhbGFuY2VcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWRpdGluZyB0byB3YWxsZXQ6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdXYWxsZXQgY3JlZGl0IGZhaWxlZCcsXHJcbiAgICAgIGRldGFpbHM6IHsgb3JpZ2luYWxFcnJvcjogZXJyb3IgfVxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuXHJcbi8vIFJlZnVuZCBhbW91bnQgdG8gd2FsbGV0IChpbiBjYXNlIG9mIEFQSSBmYWlsdXJlKVxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVmdW5kVG9XYWxsZXQoXHJcbiAgdXNlcklkOiBzdHJpbmcsXHJcbiAgYW1vdW50OiBudW1iZXIsXHJcbiAgZGVzY3JpcHRpb246IHN0cmluZyxcclxuICByZWZlcmVuY2VJZD86IHN0cmluZ1xyXG4pOiBQcm9taXNlPFdhbGxldE9wZXJhdGlvblJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgUmVmdW5kaW5nIOKCuSR7YW1vdW50fSB0byB3YWxsZXQgZm9yIHVzZXI6ICR7dXNlcklkfWApO1xyXG4gICAgY29uc29sZS5sb2coYERlc2NyaXB0aW9uOiAke2Rlc2NyaXB0aW9ufWApO1xyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHByaXNtYS4kdHJhbnNhY3Rpb24oYXN5bmMgKHR4KSA9PiB7XHJcbiAgICAgIC8vIFVwZGF0ZSB3YWxsZXQgYmFsYW5jZVxyXG4gICAgICBjb25zdCB1cGRhdGVkV2FsbGV0ID0gYXdhaXQgdHgud2FsbGV0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgYmFsYW5jZTogeyBpbmNyZW1lbnQ6IGFtb3VudCB9LFxyXG4gICAgICAgICAgdG90YWxTcGVudDogeyBkZWNyZW1lbnQ6IGFtb3VudCB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIExvZyB0aGUgcmVmdW5kIHRyYW5zYWN0aW9uXHJcbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gYXdhaXQgdHgud2FsbGV0VHJhbnNhY3Rpb24uY3JlYXRlKHtcclxuICAgICAgICBkYXRhOiB7XHJcbiAgICAgICAgICB1c2VySWQsXHJcbiAgICAgICAgICB0eXBlOiAnQ1JFRElUJyxcclxuICAgICAgICAgIGFtb3VudCxcclxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBgUkVGVU5EOiAke2Rlc2NyaXB0aW9ufWAsXHJcbiAgICAgICAgICBiYWxhbmNlQWZ0ZXI6IHVwZGF0ZWRXYWxsZXQuYmFsYW5jZSxcclxuICAgICAgICAgIHN0YXR1czogJ0NPTVBMRVRFRCcsXHJcbiAgICAgICAgICBwdXJjaGFzZU9yZGVySWQ6IHJlZmVyZW5jZUlkXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7XHJcbiAgICAgICAgbmV3QmFsYW5jZTogdXBkYXRlZFdhbGxldC5iYWxhbmNlLFxyXG4gICAgICAgIHRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uLmlkXHJcbiAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbiAgICBjb25zb2xlLmxvZyhgUmVmdW5kIHN1Y2Nlc3NmdWwgLSBOZXcgYmFsYW5jZTog4oK5JHtyZXN1bHQubmV3QmFsYW5jZX1gKTtcclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICBuZXdCYWxhbmNlOiByZXN1bHQubmV3QmFsYW5jZSxcclxuICAgICAgdHJhbnNhY3Rpb25JZDogcmVzdWx0LnRyYW5zYWN0aW9uSWQsXHJcbiAgICAgIGRldGFpbHM6IHtcclxuICAgICAgICByZWZ1bmRlZEFtb3VudDogYW1vdW50LFxyXG4gICAgICAgIG5ld0JhbGFuY2U6IHJlc3VsdC5uZXdCYWxhbmNlXHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWZ1bmRpbmcgdG8gd2FsbGV0OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnV2FsbGV0IHJlZnVuZCBmYWlsZWQnLFxyXG4gICAgICBkZXRhaWxzOiB7IG9yaWdpbmFsRXJyb3I6IGVycm9yIH1cclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyBHZXQgd2FsbGV0IHRyYW5zYWN0aW9uIGhpc3RvcnlcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFdhbGxldFRyYW5zYWN0aW9ucyhcclxuICB1c2VySWQ6IHN0cmluZyxcclxuICBsaW1pdDogbnVtYmVyID0gNTAsXHJcbiAgb2Zmc2V0OiBudW1iZXIgPSAwXHJcbik6IFByb21pc2U8RW5oYW5jZWRXYWxsZXRUcmFuc2FjdGlvbltdPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHRyYW5zYWN0aW9ucyA9IGF3YWl0IHByaXNtYS53YWxsZXRUcmFuc2FjdGlvbi5maW5kTWFueSh7XHJcbiAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxyXG4gICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXHJcbiAgICAgIHRha2U6IGxpbWl0LFxyXG4gICAgICBza2lwOiBvZmZzZXRcclxuICAgIH0pO1xyXG5cclxuICAgIHJldHVybiB0cmFuc2FjdGlvbnMubWFwKHQgPT4gKHtcclxuICAgICAgaWQ6IHQuaWQsXHJcbiAgICAgIHVzZXJJZDogdC51c2VySWQsXHJcbiAgICAgIHR5cGU6IHQudHlwZSxcclxuICAgICAgYW1vdW50OiB0LmFtb3VudCxcclxuICAgICAgZGVzY3JpcHRpb246IHQuZGVzY3JpcHRpb24sXHJcbiAgICAgIGJhbGFuY2VBZnRlcjogdC5iYWxhbmNlQWZ0ZXIsXHJcbiAgICAgIHN0YXR1czogdC5zdGF0dXMsXHJcbiAgICAgIGNyZWF0ZWRBdDogdC5jcmVhdGVkQXQsXHJcbiAgICAgIHB1cmNoYXNlT3JkZXJJZDogdC5wdXJjaGFzZU9yZGVySWQgfHwgdW5kZWZpbmVkXHJcbiAgICB9KSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHdhbGxldCB0cmFuc2FjdGlvbnM6JywgZXJyb3IpO1xyXG4gICAgcmV0dXJuIFtdO1xyXG4gIH1cclxufVxyXG5cclxuLy8gR2V0IHdhbGxldCBzdW1tYXJ5IHdpdGggZGV0YWlsZWQgYnJlYWtkb3duXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRXYWxsZXRTdW1tYXJ5KHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTx7XHJcbiAgd2FsbGV0OiBFbmhhbmNlZFdhbGxldEJhbGFuY2U7XHJcbiAgcmVjZW50VHJhbnNhY3Rpb25zOiBFbmhhbmNlZFdhbGxldFRyYW5zYWN0aW9uW107XHJcbiAgc3VtbWFyeToge1xyXG4gICAgdG90YWxDcmVkaXRzOiBudW1iZXI7XHJcbiAgICB0b3RhbERlYml0czogbnVtYmVyO1xyXG4gICAgdHJhbnNhY3Rpb25Db3VudDogbnVtYmVyO1xyXG4gICAgbGFzdFRyYW5zYWN0aW9uRGF0ZTogRGF0ZSB8IG51bGw7XHJcbiAgfTtcclxufT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB3YWxsZXQgPSBhd2FpdCBnZXRPckNyZWF0ZVdhbGxldCh1c2VySWQpO1xyXG4gICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgZ2V0V2FsbGV0VHJhbnNhY3Rpb25zKHVzZXJJZCwgMTApO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBzdW1tYXJ5IGZyb20gdHJhbnNhY3Rpb25zXHJcbiAgICBjb25zdCBhbGxUcmFuc2FjdGlvbnMgPSBhd2FpdCBwcmlzbWEud2FsbGV0VHJhbnNhY3Rpb24uZmluZE1hbnkoe1xyXG4gICAgICB3aGVyZTogeyB1c2VySWQgfSxcclxuICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgdHlwZTogdHJ1ZSxcclxuICAgICAgICBhbW91bnQ6IHRydWUsXHJcbiAgICAgICAgY3JlYXRlZEF0OiB0cnVlXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIGNvbnN0IHRvdGFsQ3JlZGl0cyA9IGFsbFRyYW5zYWN0aW9uc1xyXG4gICAgICAuZmlsdGVyKHQgPT4gdC50eXBlID09PSAnQ1JFRElUJylcclxuICAgICAgLnJlZHVjZSgoc3VtLCB0KSA9PiBzdW0gKyB0LmFtb3VudCwgMCk7XHJcblxyXG4gICAgY29uc3QgdG90YWxEZWJpdHMgPSBhbGxUcmFuc2FjdGlvbnNcclxuICAgICAgLmZpbHRlcih0ID0+IHQudHlwZSA9PT0gJ0RFQklUJylcclxuICAgICAgLnJlZHVjZSgoc3VtLCB0KSA9PiBzdW0gKyB0LmFtb3VudCwgMCk7XHJcblxyXG4gICAgY29uc3QgbGFzdFRyYW5zYWN0aW9uRGF0ZSA9IGFsbFRyYW5zYWN0aW9ucy5sZW5ndGggPiAwIFxyXG4gICAgICA/IGFsbFRyYW5zYWN0aW9ucy5zb3J0KChhLCBiKSA9PiBiLmNyZWF0ZWRBdC5nZXRUaW1lKCkgLSBhLmNyZWF0ZWRBdC5nZXRUaW1lKCkpWzBdLmNyZWF0ZWRBdFxyXG4gICAgICA6IG51bGw7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd2FsbGV0LFxyXG4gICAgICByZWNlbnRUcmFuc2FjdGlvbnM6IHRyYW5zYWN0aW9ucyxcclxuICAgICAgc3VtbWFyeToge1xyXG4gICAgICAgIHRvdGFsQ3JlZGl0cyxcclxuICAgICAgICB0b3RhbERlYml0cyxcclxuICAgICAgICB0cmFuc2FjdGlvbkNvdW50OiBhbGxUcmFuc2FjdGlvbnMubGVuZ3RoLFxyXG4gICAgICAgIGxhc3RUcmFuc2FjdGlvbkRhdGVcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyB3YWxsZXQgc3VtbWFyeTonLCBlcnJvcik7XHJcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBnZXQgd2FsbGV0IHN1bW1hcnk6ICR7ZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBEZWJ1ZyBmdW5jdGlvbiB0byBjaGVjayB3YWxsZXQgY29uc2lzdGVuY3lcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlYnVnV2FsbGV0Q29uc2lzdGVuY3kodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHtcclxuICB3YWxsZXREYXRhOiBFbmhhbmNlZFdhbGxldEJhbGFuY2UgfCBudWxsO1xyXG4gIGNhbGN1bGF0ZWRCYWxhbmNlOiBudW1iZXI7XHJcbiAgdHJhbnNhY3Rpb25Db3VudDogbnVtYmVyO1xyXG4gIGxhc3RUcmFuc2FjdGlvbjogRW5oYW5jZWRXYWxsZXRUcmFuc2FjdGlvbiB8IG51bGw7XHJcbiAgaXNDb25zaXN0ZW50OiBib29sZWFuO1xyXG4gIGlzc3Vlczogc3RyaW5nW107XHJcbn0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc29sZS5sb2coYD09PSBXQUxMRVQgREVCVUcgRk9SIFVTRVI6ICR7dXNlcklkfSA9PT1gKTtcclxuXHJcbiAgICBjb25zdCB3YWxsZXQgPSBhd2FpdCBwcmlzbWEud2FsbGV0LmZpbmRVbmlxdWUoe1xyXG4gICAgICB3aGVyZTogeyB1c2VySWQgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc3QgdHJhbnNhY3Rpb25zID0gYXdhaXQgcHJpc21hLndhbGxldFRyYW5zYWN0aW9uLmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXHJcbiAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnYXNjJyB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBsZXQgY2FsY3VsYXRlZEJhbGFuY2UgPSAwO1xyXG4gICAgY29uc3QgaXNzdWVzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgIC8vIENhbGN1bGF0ZSBiYWxhbmNlIGZyb20gdHJhbnNhY3Rpb25zXHJcbiAgICBmb3IgKGNvbnN0IHRyYW5zYWN0aW9uIG9mIHRyYW5zYWN0aW9ucykge1xyXG4gICAgICBpZiAodHJhbnNhY3Rpb24udHlwZSA9PT0gJ0NSRURJVCcpIHtcclxuICAgICAgICBjYWxjdWxhdGVkQmFsYW5jZSArPSB0cmFuc2FjdGlvbi5hbW91bnQ7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY2FsY3VsYXRlZEJhbGFuY2UgLT0gdHJhbnNhY3Rpb24uYW1vdW50O1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGFzdFRyYW5zYWN0aW9uID0gdHJhbnNhY3Rpb25zLmxlbmd0aCA+IDAgXHJcbiAgICAgID8gdHJhbnNhY3Rpb25zW3RyYW5zYWN0aW9ucy5sZW5ndGggLSAxXSBcclxuICAgICAgOiBudWxsO1xyXG5cclxuICAgIC8vIENoZWNrIGNvbnNpc3RlbmN5XHJcbiAgICBjb25zdCBpc0NvbnNpc3RlbnQgPSB3YWxsZXQgPyBNYXRoLmFicyh3YWxsZXQuYmFsYW5jZSAtIGNhbGN1bGF0ZWRCYWxhbmNlKSA8IDAuMDEgOiBjYWxjdWxhdGVkQmFsYW5jZSA9PT0gMDtcclxuXHJcbiAgICBpZiAoIXdhbGxldCkge1xyXG4gICAgICBpc3N1ZXMucHVzaCgnV2FsbGV0IHJlY29yZCBkb2VzIG5vdCBleGlzdCcpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgaWYgKCFpc0NvbnNpc3RlbnQpIHtcclxuICAgICAgICBpc3N1ZXMucHVzaChgQmFsYW5jZSBtaXNtYXRjaDogV2FsbGV0IHNob3dzIOKCuSR7d2FsbGV0LmJhbGFuY2V9LCBjYWxjdWxhdGVkIOKCuSR7Y2FsY3VsYXRlZEJhbGFuY2V9YCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKGxhc3RUcmFuc2FjdGlvbiAmJiBNYXRoLmFicyhsYXN0VHJhbnNhY3Rpb24uYmFsYW5jZUFmdGVyIC0gd2FsbGV0LmJhbGFuY2UpID4gMC4wMSkge1xyXG4gICAgICAgIGlzc3Vlcy5wdXNoKGBMYXN0IHRyYW5zYWN0aW9uIGJhbGFuY2UgbWlzbWF0Y2g6IFRyYW5zYWN0aW9uIHNob3dzIOKCuSR7bGFzdFRyYW5zYWN0aW9uLmJhbGFuY2VBZnRlcn0sIHdhbGxldCBzaG93cyDigrkke3dhbGxldC5iYWxhbmNlfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc29sZS5sb2coYFdhbGxldCBleGlzdHM6ICR7ISF3YWxsZXR9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgU3RvcmVkIGJhbGFuY2U6IOKCuSR7d2FsbGV0Py5iYWxhbmNlIHx8IDB9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgQ2FsY3VsYXRlZCBiYWxhbmNlOiDigrkke2NhbGN1bGF0ZWRCYWxhbmNlfWApO1xyXG4gICAgY29uc29sZS5sb2coYFRyYW5zYWN0aW9uIGNvdW50OiAke3RyYW5zYWN0aW9ucy5sZW5ndGh9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgSXMgY29uc2lzdGVudDogJHtpc0NvbnNpc3RlbnR9YCk7XHJcbiAgICBjb25zb2xlLmxvZyhgSXNzdWVzOiAke2lzc3Vlcy5sZW5ndGggPiAwID8gaXNzdWVzLmpvaW4oJywgJykgOiAnTm9uZSd9YCk7XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd2FsbGV0RGF0YTogd2FsbGV0ID8ge1xyXG4gICAgICAgIHVzZXJJZDogd2FsbGV0LnVzZXJJZCxcclxuICAgICAgICBiYWxhbmNlOiB3YWxsZXQuYmFsYW5jZSxcclxuICAgICAgICB0b3RhbEVhcm5lZDogd2FsbGV0LnRvdGFsRWFybmVkLFxyXG4gICAgICAgIHRvdGFsU3BlbnQ6IHdhbGxldC50b3RhbFNwZW50LFxyXG4gICAgICAgIGxhc3RSZWNoYXJnZTogd2FsbGV0Lmxhc3RSZWNoYXJnZSxcclxuICAgICAgICBjcmVhdGVkQXQ6IHdhbGxldC5jcmVhdGVkQXQsXHJcbiAgICAgICAgdXBkYXRlZEF0OiB3YWxsZXQudXBkYXRlZEF0XHJcbiAgICAgIH0gOiBudWxsLFxyXG4gICAgICBjYWxjdWxhdGVkQmFsYW5jZSxcclxuICAgICAgdHJhbnNhY3Rpb25Db3VudDogdHJhbnNhY3Rpb25zLmxlbmd0aCxcclxuICAgICAgbGFzdFRyYW5zYWN0aW9uOiBsYXN0VHJhbnNhY3Rpb24gPyB7XHJcbiAgICAgICAgaWQ6IGxhc3RUcmFuc2FjdGlvbi5pZCxcclxuICAgICAgICB1c2VySWQ6IGxhc3RUcmFuc2FjdGlvbi51c2VySWQsXHJcbiAgICAgICAgdHlwZTogbGFzdFRyYW5zYWN0aW9uLnR5cGUsXHJcbiAgICAgICAgYW1vdW50OiBsYXN0VHJhbnNhY3Rpb24uYW1vdW50LFxyXG4gICAgICAgIGRlc2NyaXB0aW9uOiBsYXN0VHJhbnNhY3Rpb24uZGVzY3JpcHRpb24sXHJcbiAgICAgICAgYmFsYW5jZUFmdGVyOiBsYXN0VHJhbnNhY3Rpb24uYmFsYW5jZUFmdGVyLFxyXG4gICAgICAgIHN0YXR1czogbGFzdFRyYW5zYWN0aW9uLnN0YXR1cyxcclxuICAgICAgICBjcmVhdGVkQXQ6IGxhc3RUcmFuc2FjdGlvbi5jcmVhdGVkQXQsXHJcbiAgICAgICAgcHVyY2hhc2VPcmRlcklkOiBsYXN0VHJhbnNhY3Rpb24ucHVyY2hhc2VPcmRlcklkIHx8IHVuZGVmaW5lZFxyXG4gICAgICB9IDogbnVsbCxcclxuICAgICAgaXNDb25zaXN0ZW50LFxyXG4gICAgICBpc3N1ZXNcclxuICAgIH07XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGRlYnVnZ2luZyB3YWxsZXQgY29uc2lzdGVuY3k6JywgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBDaGVjayBlbmhhbmNlZCB3YWxsZXQgYmFsYW5jZSAoYWxpYXMgZm9yIGNoZWNrV2FsbGV0QmFsYW5jZSlcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrRW5oYW5jZWRXYWxsZXRCYWxhbmNlKFxyXG4gIHVzZXJJZDogc3RyaW5nLFxyXG4gIHJlcXVpcmVkQW1vdW50OiBudW1iZXJcclxuKTogUHJvbWlzZTxCYWxhbmNlQ2hlY2tSZXN1bHQ+IHtcclxuICByZXR1cm4gY2hlY2tXYWxsZXRCYWxhbmNlKHVzZXJJZCwgcmVxdWlyZWRBbW91bnQpO1xyXG59XHJcblxyXG4vLyBQcm9jZXNzIHJldHVybiBjb3VyaWVyIGNvc3RcclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NSZXR1cm5Db3VyaWVyQ29zdChcclxuICB1c2VySWQ6IHN0cmluZyxcclxuICBhbW91bnQ6IG51bWJlcixcclxuICByZXR1cm5SZWFzb246IHN0cmluZyxcclxuICBjb3N0UmVzcG9uc2liaWxpdHk6ICdCUkFORCcgfCAnU0VSVklDRV9DRU5URVInIHwgJ0NVU1RPTUVSJyxcclxuICByZWZlcmVuY2VJZD86IHN0cmluZ1xyXG4pOiBQcm9taXNlPFdhbGxldE9wZXJhdGlvblJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyByZXR1cm4gY291cmllciBjb3N0IGZvciB1c2VyOiAke3VzZXJJZH1gKTtcclxuICAgIGNvbnNvbGUubG9nKGBBbW91bnQ6IOKCuSR7YW1vdW50fSwgUmVhc29uOiAke3JldHVyblJlYXNvbn0sIFJlc3BvbnNpYmlsaXR5OiAke2Nvc3RSZXNwb25zaWJpbGl0eX1gKTtcclxuXHJcbiAgICAvLyBEZXRlcm1pbmUgd2hvIHBheXMgYmFzZWQgb24gY29zdCByZXNwb25zaWJpbGl0eVxyXG4gICAgaWYgKGNvc3RSZXNwb25zaWJpbGl0eSA9PT0gJ0JSQU5EJykge1xyXG4gICAgICAvLyBCcmFuZCBwYXlzIC0gbm8gZGVkdWN0aW9uIGZyb20gdXNlciB3YWxsZXRcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgIGRldGFpbHM6IHtcclxuICAgICAgICAgIG1lc3NhZ2U6ICdSZXR1cm4gY29zdCBjb3ZlcmVkIGJ5IGJyYW5kJyxcclxuICAgICAgICAgIGNvc3RSZXNwb25zaWJpbGl0eSxcclxuICAgICAgICAgIGFtb3VudFxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgIH0gZWxzZSBpZiAoY29zdFJlc3BvbnNpYmlsaXR5ID09PSAnU0VSVklDRV9DRU5URVInKSB7XHJcbiAgICAgIC8vIFNlcnZpY2UgY2VudGVyIHBheXMgLSBkZWR1Y3QgZnJvbSB0aGVpciB3YWxsZXRcclxuICAgICAgcmV0dXJuIGF3YWl0IGRlZHVjdEZyb21XYWxsZXQoXHJcbiAgICAgICAgdXNlcklkLFxyXG4gICAgICAgIGFtb3VudCxcclxuICAgICAgICBgUmV0dXJuIGNvdXJpZXIgY29zdCAtICR7cmV0dXJuUmVhc29ufWAsXHJcbiAgICAgICAgcmVmZXJlbmNlSWRcclxuICAgICAgKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIEN1c3RvbWVyIHBheXMgLSBoYW5kbGUgc2VwYXJhdGVseSBvciByZXR1cm4gZXJyb3JcclxuICAgICAgcmV0dXJuIHtcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0N1c3RvbWVyIHBheW1lbnQgbm90IGhhbmRsZWQgdGhyb3VnaCB3YWxsZXQgc3lzdGVtJyxcclxuICAgICAgICBkZXRhaWxzOiB7XHJcbiAgICAgICAgICBjb3N0UmVzcG9uc2liaWxpdHksXHJcbiAgICAgICAgICBhbW91bnRcclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHByb2Nlc3NpbmcgcmV0dXJuIGNvdXJpZXIgY29zdDonLCBlcnJvcik7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0ZhaWxlZCB0byBwcm9jZXNzIHJldHVybiBjb3VyaWVyIGNvc3QnLFxyXG4gICAgICBkZXRhaWxzOiB7IG9yaWdpbmFsRXJyb3I6IGVycm9yIH1cclxuICAgIH07XHJcbiAgfVxyXG59XHJcblxyXG4vLyBBZG1pbiB3YWxsZXQgYWRqdXN0bWVudCBmdW5jdGlvblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gYWRtaW5XYWxsZXRBZGp1c3RtZW50KFxyXG4gIHVzZXJJZDogc3RyaW5nLFxyXG4gIGFtb3VudDogbnVtYmVyLFxyXG4gIHR5cGU6ICdDUkVESVQnIHwgJ0RFQklUJyxcclxuICBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG4gIGFkbWluSWQ6IHN0cmluZ1xyXG4pOiBQcm9taXNlPFdhbGxldE9wZXJhdGlvblJlc3VsdD4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhgQWRtaW4gd2FsbGV0IGFkanVzdG1lbnQgZm9yIHVzZXI6ICR7dXNlcklkfWApO1xyXG4gICAgY29uc29sZS5sb2coYFR5cGU6ICR7dHlwZX0sIEFtb3VudDog4oK5JHthbW91bnR9LCBBZG1pbjogJHthZG1pbklkfWApO1xyXG5cclxuICAgIGNvbnN0IGFkanVzdG1lbnREZXNjcmlwdGlvbiA9IGBBRE1JTiBBREpVU1RNRU5UIGJ5ICR7YWRtaW5JZH06ICR7ZGVzY3JpcHRpb259YDtcclxuXHJcbiAgICBpZiAodHlwZSA9PT0gJ0NSRURJVCcpIHtcclxuICAgICAgcmV0dXJuIGF3YWl0IGNyZWRpdFRvV2FsbGV0KHVzZXJJZCwgYW1vdW50LCBhZGp1c3RtZW50RGVzY3JpcHRpb24pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIGF3YWl0IGRlZHVjdEZyb21XYWxsZXQodXNlcklkLCBhbW91bnQsIGFkanVzdG1lbnREZXNjcmlwdGlvbik7XHJcbiAgICB9XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGFkbWluIHdhbGxldCBhZGp1c3RtZW50OicsIGVycm9yKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxyXG4gICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnQWRtaW4gd2FsbGV0IGFkanVzdG1lbnQgZmFpbGVkJyxcclxuICAgICAgZGV0YWlsczogeyBvcmlnaW5hbEVycm9yOiBlcnJvciB9XHJcbiAgICB9O1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJwcmlzbWEiLCJnZXRPckNyZWF0ZVdhbGxldCIsInVzZXJJZCIsIndhbGxldCIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImNvbnNvbGUiLCJsb2ciLCJjcmVhdGUiLCJkYXRhIiwiYmFsYW5jZSIsInRvdGFsRWFybmVkIiwidG90YWxTcGVudCIsImxhc3RSZWNoYXJnZSIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsImVycm9yIiwiRXJyb3IiLCJtZXNzYWdlIiwiY2hlY2tXYWxsZXRCYWxhbmNlIiwicmVxdWlyZWRBbW91bnQiLCJzdWZmaWNpZW50IiwiY3VycmVudEJhbGFuY2UiLCJzaG9ydGZhbGwiLCJ3YWxsZXRFeGlzdHMiLCJ1bmRlZmluZWQiLCJkZWR1Y3RGcm9tV2FsbGV0IiwiYW1vdW50IiwiZGVzY3JpcHRpb24iLCJyZWZlcmVuY2VJZCIsImJhbGFuY2VDaGVjayIsInN1Y2Nlc3MiLCJkZXRhaWxzIiwiYXZhaWxhYmxlQmFsYW5jZSIsInJlc3VsdCIsIiR0cmFuc2FjdGlvbiIsInR4IiwidXBkYXRlZFdhbGxldCIsInVwZGF0ZSIsImRlY3JlbWVudCIsImluY3JlbWVudCIsInRyYW5zYWN0aW9uIiwid2FsbGV0VHJhbnNhY3Rpb24iLCJ0eXBlIiwiYmFsYW5jZUFmdGVyIiwic3RhdHVzIiwicHVyY2hhc2VPcmRlcklkIiwiaWQiLCJuZXdCYWxhbmNlIiwidHJhbnNhY3Rpb25JZCIsImRlZHVjdGVkQW1vdW50IiwicHJldmlvdXNCYWxhbmNlIiwib3JpZ2luYWxFcnJvciIsImNyZWRpdFRvV2FsbGV0IiwiRGF0ZSIsImNyZWRpdGVkQW1vdW50IiwicmVmdW5kVG9XYWxsZXQiLCJyZWZ1bmRlZEFtb3VudCIsImdldFdhbGxldFRyYW5zYWN0aW9ucyIsImxpbWl0Iiwib2Zmc2V0IiwidHJhbnNhY3Rpb25zIiwiZmluZE1hbnkiLCJvcmRlckJ5IiwidGFrZSIsInNraXAiLCJtYXAiLCJ0IiwiZ2V0V2FsbGV0U3VtbWFyeSIsImFsbFRyYW5zYWN0aW9ucyIsInNlbGVjdCIsInRvdGFsQ3JlZGl0cyIsImZpbHRlciIsInJlZHVjZSIsInN1bSIsInRvdGFsRGViaXRzIiwibGFzdFRyYW5zYWN0aW9uRGF0ZSIsImxlbmd0aCIsInNvcnQiLCJhIiwiYiIsImdldFRpbWUiLCJyZWNlbnRUcmFuc2FjdGlvbnMiLCJzdW1tYXJ5IiwidHJhbnNhY3Rpb25Db3VudCIsImRlYnVnV2FsbGV0Q29uc2lzdGVuY3kiLCJjYWxjdWxhdGVkQmFsYW5jZSIsImlzc3VlcyIsImxhc3RUcmFuc2FjdGlvbiIsImlzQ29uc2lzdGVudCIsIk1hdGgiLCJhYnMiLCJwdXNoIiwiam9pbiIsIndhbGxldERhdGEiLCJjaGVja0VuaGFuY2VkV2FsbGV0QmFsYW5jZSIsInByb2Nlc3NSZXR1cm5Db3VyaWVyQ29zdCIsInJldHVyblJlYXNvbiIsImNvc3RSZXNwb25zaWJpbGl0eSIsImFkbWluV2FsbGV0QWRqdXN0bWVudCIsImFkbWluSWQiLCJhZGp1c3RtZW50RGVzY3JpcHRpb24iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./src/lib/enhanced-wallet.ts\n')},"(api)/./src/lib/prisma.ts":(module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client_edge__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client/edge */ "@prisma/client/edge");\n/* harmony import */ var _prisma_client_edge__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client_edge__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _prisma_extension_accelerate__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @prisma/extension-accelerate */ "@prisma/extension-accelerate");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_prisma_extension_accelerate__WEBPACK_IMPORTED_MODULE_1__]);\n_prisma_extension_accelerate__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client_edge__WEBPACK_IMPORTED_MODULE_0__.PrismaClient().$extends((0,_prisma_extension_accelerate__WEBPACK_IMPORTED_MODULE_1__.withAccelerate)());\nif (true) globalForPrisma.prisma = prisma;\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQWtEO0FBQ1c7QUFFN0QsTUFBTUUsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSiw2REFBWUEsR0FBR0ssUUFBUSxDQUFDSiw0RUFBY0EsSUFBRztBQUU3RixJQUFJSyxJQUF5QixFQUFjSixnQkFBZ0JFLE1BQU0sR0FBR0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0LXBhZ2VzLWNoYWtyYS8uL3NyYy9saWIvcHJpc21hLnRzPzAxZDciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUHJpc21hQ2xpZW50IH0gZnJvbSAnQHByaXNtYS9jbGllbnQvZWRnZSdcclxuaW1wb3J0IHsgd2l0aEFjY2VsZXJhdGUgfSBmcm9tICdAcHJpc21hL2V4dGVuc2lvbi1hY2NlbGVyYXRlJ1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcclxuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KCkuJGV4dGVuZHMod2l0aEFjY2VsZXJhdGUoKSlcclxuXHJcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hIl0sIm5hbWVzIjpbIlByaXNtYUNsaWVudCIsIndpdGhBY2NlbGVyYXRlIiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsIiRleHRlbmRzIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/lib/prisma.ts\n')},"(api)/./src/pages/api/reverse-requests.ts":(module,__webpack_exports__,__webpack_require__)=>{eval('__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   "default": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ "(api)/./src/lib/prisma.ts");\n/* harmony import */ var _lib_enhanced_wallet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/enhanced-wallet */ "(api)/./src/lib/enhanced-wallet.ts");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_lib_prisma__WEBPACK_IMPORTED_MODULE_0__, _lib_enhanced_wallet__WEBPACK_IMPORTED_MODULE_1__]);\n([_lib_prisma__WEBPACK_IMPORTED_MODULE_0__, _lib_enhanced_wallet__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n// Function to determine cost responsibility based on return reason\nfunction determineReturnCostResponsibility(returnReason) {\n    switch(returnReason){\n        case "DEFECTIVE":\n        case "WRONG_PART":\n        case "QUALITY_ISSUE":\n        case "DAMAGED":\n            return "BRAND"; // Brand pays for defective/wrong parts\n        case "EXCESS_STOCK":\n        case "INVENTORY_CLEANUP":\n            return "SERVICE_CENTER"; // Service center pays for excess inventory\n        case "CUSTOMER_RETURN":\n            return "CUSTOMER"; // Customer pays for their returns\n        default:\n            return "SERVICE_CENTER"; // Default fallback\n    }\n}\n// Function to estimate return courier cost (simplified for now)\nfunction estimateReturnCourierCost(weight = 1) {\n    // DTDC reverse logistics pricing: ₹100 docket + ₹65/kg\n    const docketCharge = 100;\n    const perKgCharge = 65;\n    return docketCharge + Math.ceil(weight) * perKgCharge;\n}\nasync function handler(req, res) {\n    if (req.method === "GET") {\n        try {\n            const { brandId, serviceCenterId } = req.query;\n            let whereClause = {};\n            // Filter by brand if brandId is provided\n            if (brandId) {\n                whereClause.part = {\n                    brandId: brandId\n                };\n            }\n            // Filter by service center if serviceCenterId is provided\n            if (serviceCenterId) {\n                whereClause.serviceCenterId = serviceCenterId;\n            }\n            const reverseRequests = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.reverseRequest.findMany({\n                where: whereClause,\n                include: {\n                    serviceCenter: true,\n                    part: {\n                        include: {\n                            brand: true\n                        }\n                    }\n                },\n                orderBy: {\n                    createdAt: "desc"\n                }\n            });\n            res.status(200).json(reverseRequests);\n        } catch (error) {\n            console.error("Error fetching reverse requests:", error);\n            res.status(500).json({\n                error: "Failed to fetch reverse requests"\n            });\n        }\n    } else if (req.method === "POST") {\n        try {\n            const { serviceCenterId, partId, reason, returnReason, status, quantity, weight, processPayment } = req.body;\n            // Validate required fields\n            if (!serviceCenterId || !partId || !reason) {\n                return res.status(400).json({\n                    error: "Missing required fields: serviceCenterId, partId, reason"\n                });\n            }\n            // Determine cost responsibility based on return reason\n            const costResponsibility = returnReason ? determineReturnCostResponsibility(returnReason) : "SERVICE_CENTER";\n            // Estimate courier cost\n            const estimatedCourierCost = estimateReturnCourierCost(weight || 1);\n            // If processPayment is true, check wallet balance and process payment\n            let walletDeductionResult = null;\n            if (processPayment) {\n                // Determine who pays\n                let payerId;\n                if (costResponsibility === "BRAND") {\n                    // Get brand ID from part\n                    const part = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.part.findUnique({\n                        where: {\n                            id: partId\n                        },\n                        select: {\n                            brandId: true\n                        }\n                    });\n                    if (!part) {\n                        return res.status(400).json({\n                            error: "Part not found"\n                        });\n                    }\n                    payerId = part.brandId;\n                } else if (costResponsibility === "SERVICE_CENTER") {\n                    payerId = serviceCenterId;\n                } else {\n                    return res.status(400).json({\n                        error: "Customer payment not supported in this version"\n                    });\n                }\n                // Check wallet balance\n                const balanceCheck = await (0,_lib_enhanced_wallet__WEBPACK_IMPORTED_MODULE_1__.checkEnhancedWalletBalance)(payerId, estimatedCourierCost);\n                if (!balanceCheck || !balanceCheck.sufficient) {\n                    return res.status(400).json({\n                        error: "Insufficient wallet balance",\n                        required: estimatedCourierCost,\n                        available: balanceCheck?.currentBalance || 0,\n                        shortfall: balanceCheck?.shortfall || estimatedCourierCost\n                    });\n                }\n            }\n            const reverseRequest = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.reverseRequest.create({\n                data: {\n                    serviceCenterId,\n                    partId,\n                    reason,\n                    returnReason: returnReason || null,\n                    costResponsibility,\n                    courierCost: processPayment ? estimatedCourierCost : null,\n                    quantity: quantity || 1,\n                    status: status || "REQUESTED"\n                },\n                include: {\n                    serviceCenter: true,\n                    part: {\n                        include: {\n                            brand: true\n                        }\n                    }\n                }\n            });\n            // Process wallet deduction if requested\n            if (processPayment) {\n                walletDeductionResult = await (0,_lib_enhanced_wallet__WEBPACK_IMPORTED_MODULE_1__.processReturnCourierCost)(reverseRequest.id, estimatedCourierCost, false // not admin override\n                );\n                if (!walletDeductionResult.success) {\n                    // Rollback the reverse request creation\n                    await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.reverseRequest.delete({\n                        where: {\n                            id: reverseRequest.id\n                        }\n                    });\n                    return res.status(400).json({\n                        error: "Wallet deduction failed",\n                        details: walletDeductionResult.error\n                    });\n                }\n            }\n            res.status(201).json({\n                success: true,\n                reverseRequest,\n                costInfo: {\n                    costResponsibility,\n                    estimatedCourierCost,\n                    message: `Courier cost will be borne by: ${costResponsibility.replace("_", " ")}`,\n                    walletDeducted: processPayment,\n                    walletResult: walletDeductionResult\n                }\n            });\n        } catch (error) {\n            console.error("Error creating reverse request:", error);\n            res.status(500).json({\n                error: "Failed to create reverse request"\n            });\n        }\n    } else if (req.method === "PUT") {\n        try {\n            const { id, status, awbNumber, courierCost, paidBy } = req.body;\n            if (!id) {\n                return res.status(400).json({\n                    error: "Request ID is required"\n                });\n            }\n            const updateData = {};\n            if (status) updateData.status = status;\n            if (awbNumber) updateData.awbNumber = awbNumber;\n            if (courierCost !== undefined) updateData.courierCost = courierCost;\n            if (paidBy) updateData.paidBy = paidBy;\n            const reverseRequest = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.reverseRequest.update({\n                where: {\n                    id\n                },\n                data: updateData,\n                include: {\n                    serviceCenter: true,\n                    part: {\n                        include: {\n                            brand: true\n                        }\n                    }\n                }\n            });\n            res.status(200).json(reverseRequest);\n        } catch (error) {\n            console.error("Error updating reverse request:", error);\n            res.status(500).json({\n                error: "Failed to update reverse request"\n            });\n        }\n    } else {\n        res.setHeader("Allow", [\n            "GET",\n            "POST",\n            "PUT"\n        ]);\n        res.status(405).end(`Method ${req.method} Not Allowed`);\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvcGFnZXMvYXBpL3JldmVyc2UtcmVxdWVzdHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ3FDO0FBQ3FFO0FBRTFHLG1FQUFtRTtBQUNuRSxTQUFTRyxrQ0FBa0NDLFlBQW9CO0lBQzdELE9BQU9BO1FBQ0wsS0FBSztRQUNMLEtBQUs7UUFDTCxLQUFLO1FBQ0wsS0FBSztZQUNILE9BQU8sU0FBUyx1Q0FBdUM7UUFFekQsS0FBSztRQUNMLEtBQUs7WUFDSCxPQUFPLGtCQUFrQiwyQ0FBMkM7UUFFdEUsS0FBSztZQUNILE9BQU8sWUFBWSxrQ0FBa0M7UUFFdkQ7WUFDRSxPQUFPLGtCQUFrQixtQkFBbUI7SUFDaEQ7QUFDRjtBQUVBLGdFQUFnRTtBQUNoRSxTQUFTQywwQkFBMEJDLFNBQWlCLENBQUM7SUFDbkQsdURBQXVEO0lBQ3ZELE1BQU1DLGVBQWU7SUFDckIsTUFBTUMsY0FBYztJQUNwQixPQUFPRCxlQUFnQkUsS0FBS0MsSUFBSSxDQUFDSixVQUFVRTtBQUM3QztBQUVlLGVBQWVHLFFBQVFDLEdBQW1CLEVBQUVDLEdBQW9CO0lBQzdFLElBQUlELElBQUlFLE1BQU0sS0FBSyxPQUFPO1FBQ3hCLElBQUk7WUFDRixNQUFNLEVBQUVDLE9BQU8sRUFBRUMsZUFBZSxFQUFFLEdBQUdKLElBQUlLLEtBQUs7WUFFOUMsSUFBSUMsY0FBbUIsQ0FBQztZQUV4Qix5Q0FBeUM7WUFDekMsSUFBSUgsU0FBUztnQkFDWEcsWUFBWUMsSUFBSSxHQUFHO29CQUNqQkosU0FBU0E7Z0JBQ1g7WUFDRjtZQUVBLDBEQUEwRDtZQUMxRCxJQUFJQyxpQkFBaUI7Z0JBQ25CRSxZQUFZRixlQUFlLEdBQUdBO1lBQ2hDO1lBRUEsTUFBTUksa0JBQWtCLE1BQU1wQiwrQ0FBTUEsQ0FBQ3FCLGNBQWMsQ0FBQ0MsUUFBUSxDQUFDO2dCQUMzREMsT0FBT0w7Z0JBQ1BNLFNBQVM7b0JBQ1BDLGVBQWU7b0JBQ2ZOLE1BQU07d0JBQ0pLLFNBQVM7NEJBQ1BFLE9BQU87d0JB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QVcsR0FBR0E7WUFDeEQsSUFBSVUsUUFBUUMsV0FBV0QsTUFBTSxHQUFHQTtZQUVoQyxNQUFNMUMsaUJBQWlCLE1BQU1yQiwrQ0FBTUEsQ0FBQ3FCLGNBQWMsQ0FBQzZDLE1BQU0sQ0FBQztnQkFDeEQzQyxPQUFPO29CQUFFb0I7Z0JBQUc7Z0JBQ1pTLE1BQU1ZO2dCQUNOeEMsU0FBUztvQkFDUEMsZUFBZTtvQkFDZk4sTUFBTTt3QkFDSkssU0FBUzs0QkFDUEUsT0FBTzt3QkFDVDtvQkFDRjtnQkFDRjtZQUNGO1lBRUFiLElBQUlnQixNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDVDtRQUN2QixFQUFFLE9BQU9VLE9BQU87WUFDZEMsUUFBUUQsS0FBSyxDQUFDLG1DQUFtQ0E7WUFDakRsQixJQUFJZ0IsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFtQztRQUNuRTtJQUNGLE9BQU87UUFDTGxCLElBQUlzRCxTQUFTLENBQUMsU0FBUztZQUFDO1lBQU87WUFBUTtTQUFNO1FBQzdDdEQsSUFBSWdCLE1BQU0sQ0FBQyxLQUFLdUMsR0FBRyxDQUFDLENBQUMsT0FBTyxFQUFFeEQsSUFBSUUsTUFBTSxDQUFDLFlBQVksQ0FBQztJQUN4RDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dC1wYWdlcy1jaGFrcmEvLi9zcmMvcGFnZXMvYXBpL3JldmVyc2UtcmVxdWVzdHMudHM/YmUwOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0QXBpUmVxdWVzdCwgTmV4dEFwaVJlc3BvbnNlIH0gZnJvbSAnbmV4dCdcclxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvcHJpc21hJ1xyXG5pbXBvcnQgeyBkZWR1Y3RBbW91bnQsIHByb2Nlc3NSZXR1cm5Db3VyaWVyQ29zdCwgY2hlY2tFbmhhbmNlZFdhbGxldEJhbGFuY2UgfSBmcm9tICdAL2xpYi9lbmhhbmNlZC13YWxsZXQnXHJcblxyXG4vLyBGdW5jdGlvbiB0byBkZXRlcm1pbmUgY29zdCByZXNwb25zaWJpbGl0eSBiYXNlZCBvbiByZXR1cm4gcmVhc29uXHJcbmZ1bmN0aW9uIGRldGVybWluZVJldHVybkNvc3RSZXNwb25zaWJpbGl0eShyZXR1cm5SZWFzb246IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgc3dpdGNoKHJldHVyblJlYXNvbikge1xyXG4gICAgY2FzZSAnREVGRUNUSVZFJzpcclxuICAgIGNhc2UgJ1dST05HX1BBUlQnOlxyXG4gICAgY2FzZSAnUVVBTElUWV9JU1NVRSc6XHJcbiAgICBjYXNlICdEQU1BR0VEJzpcclxuICAgICAgcmV0dXJuICdCUkFORCc7IC8vIEJyYW5kIHBheXMgZm9yIGRlZmVjdGl2ZS93cm9uZyBwYXJ0c1xyXG4gICAgXHJcbiAgICBjYXNlICdFWENFU1NfU1RPQ0snOlxyXG4gICAgY2FzZSAnSU5WRU5UT1JZX0NMRUFOVVAnOlxyXG4gICAgICByZXR1cm4gJ1NFUlZJQ0VfQ0VOVEVSJzsgLy8gU2VydmljZSBjZW50ZXIgcGF5cyBmb3IgZXhjZXNzIGludmVudG9yeVxyXG4gICAgXHJcbiAgICBjYXNlICdDVVNUT01FUl9SRVRVUk4nOlxyXG4gICAgICByZXR1cm4gJ0NVU1RPTUVSJzsgLy8gQ3VzdG9tZXIgcGF5cyBmb3IgdGhlaXIgcmV0dXJuc1xyXG4gICAgXHJcbiAgICBkZWZhdWx0OlxyXG4gICAgICByZXR1cm4gJ1NFUlZJQ0VfQ0VOVEVSJzsgLy8gRGVmYXVsdCBmYWxsYmFja1xyXG4gIH1cclxufVxyXG5cclxuLy8gRnVuY3Rpb24gdG8gZXN0aW1hdGUgcmV0dXJuIGNvdXJpZXIgY29zdCAoc2ltcGxpZmllZCBmb3Igbm93KVxyXG5mdW5jdGlvbiBlc3RpbWF0ZVJldHVybkNvdXJpZXJDb3N0KHdlaWdodDogbnVtYmVyID0gMSk6IG51bWJlciB7XHJcbiAgLy8gRFREQyByZXZlcnNlIGxvZ2lzdGljcyBwcmljaW5nOiDigrkxMDAgZG9ja2V0ICsg4oK5NjUva2dcclxuICBjb25zdCBkb2NrZXRDaGFyZ2UgPSAxMDA7XHJcbiAgY29uc3QgcGVyS2dDaGFyZ2UgPSA2NTtcclxuICByZXR1cm4gZG9ja2V0Q2hhcmdlICsgKE1hdGguY2VpbCh3ZWlnaHQpICogcGVyS2dDaGFyZ2UpO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcTogTmV4dEFwaVJlcXVlc3QsIHJlczogTmV4dEFwaVJlc3BvbnNlKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgPT09ICdHRVQnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IGJyYW5kSWQsIHNlcnZpY2VDZW50ZXJJZCB9ID0gcmVxLnF1ZXJ5XHJcbiAgICAgIFxyXG4gICAgICBsZXQgd2hlcmVDbGF1c2U6IGFueSA9IHt9XHJcbiAgICAgIFxyXG4gICAgICAvLyBGaWx0ZXIgYnkgYnJhbmQgaWYgYnJhbmRJZCBpcyBwcm92aWRlZFxyXG4gICAgICBpZiAoYnJhbmRJZCkge1xyXG4gICAgICAgIHdoZXJlQ2xhdXNlLnBhcnQgPSB7XHJcbiAgICAgICAgICBicmFuZElkOiBicmFuZElkIGFzIHN0cmluZ1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gRmlsdGVyIGJ5IHNlcnZpY2UgY2VudGVyIGlmIHNlcnZpY2VDZW50ZXJJZCBpcyBwcm92aWRlZFxyXG4gICAgICBpZiAoc2VydmljZUNlbnRlcklkKSB7XHJcbiAgICAgICAgd2hlcmVDbGF1c2Uuc2VydmljZUNlbnRlcklkID0gc2VydmljZUNlbnRlcklkIGFzIHN0cmluZ1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCByZXZlcnNlUmVxdWVzdHMgPSBhd2FpdCBwcmlzbWEucmV2ZXJzZVJlcXVlc3QuZmluZE1hbnkoe1xyXG4gICAgICAgIHdoZXJlOiB3aGVyZUNsYXVzZSxcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICBzZXJ2aWNlQ2VudGVyOiB0cnVlLFxyXG4gICAgICAgICAgcGFydDoge1xyXG4gICAgICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICAgICAgYnJhbmQ6IHRydWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgb3JkZXJCeToge1xyXG4gICAgICAgICAgY3JlYXRlZEF0OiAnZGVzYycsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSlcclxuICAgICAgXHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJldmVyc2VSZXF1ZXN0cylcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHJldmVyc2UgcmVxdWVzdHM6JywgZXJyb3IpXHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggcmV2ZXJzZSByZXF1ZXN0cycgfSlcclxuICAgIH1cclxuICB9IGVsc2UgaWYgKHJlcS5tZXRob2QgPT09ICdQT1NUJykge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgeyBzZXJ2aWNlQ2VudGVySWQsIHBhcnRJZCwgcmVhc29uLCByZXR1cm5SZWFzb24sIHN0YXR1cywgcXVhbnRpdHksIHdlaWdodCwgcHJvY2Vzc1BheW1lbnQgfSA9IHJlcS5ib2R5XHJcbiAgICAgIFxyXG4gICAgICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBmaWVsZHNcclxuICAgICAgaWYgKCFzZXJ2aWNlQ2VudGVySWQgfHwgIXBhcnRJZCB8fCAhcmVhc29uKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdNaXNzaW5nIHJlcXVpcmVkIGZpZWxkczogc2VydmljZUNlbnRlcklkLCBwYXJ0SWQsIHJlYXNvbicgfSlcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRGV0ZXJtaW5lIGNvc3QgcmVzcG9uc2liaWxpdHkgYmFzZWQgb24gcmV0dXJuIHJlYXNvblxyXG4gICAgICBjb25zdCBjb3N0UmVzcG9uc2liaWxpdHkgPSByZXR1cm5SZWFzb24gPyBkZXRlcm1pbmVSZXR1cm5Db3N0UmVzcG9uc2liaWxpdHkocmV0dXJuUmVhc29uKSA6ICdTRVJWSUNFX0NFTlRFUidcclxuICAgICAgXHJcbiAgICAgIC8vIEVzdGltYXRlIGNvdXJpZXIgY29zdFxyXG4gICAgICBjb25zdCBlc3RpbWF0ZWRDb3VyaWVyQ29zdCA9IGVzdGltYXRlUmV0dXJuQ291cmllckNvc3Qod2VpZ2h0IHx8IDEpO1xyXG4gICAgICBcclxuICAgICAgLy8gSWYgcHJvY2Vzc1BheW1lbnQgaXMgdHJ1ZSwgY2hlY2sgd2FsbGV0IGJhbGFuY2UgYW5kIHByb2Nlc3MgcGF5bWVudFxyXG4gICAgICBsZXQgd2FsbGV0RGVkdWN0aW9uUmVzdWx0ID0gbnVsbDtcclxuICAgICAgaWYgKHByb2Nlc3NQYXltZW50KSB7XHJcbiAgICAgICAgLy8gRGV0ZXJtaW5lIHdobyBwYXlzXHJcbiAgICAgICAgbGV0IHBheWVySWQ6IHN0cmluZztcclxuICAgICAgICBpZiAoY29zdFJlc3BvbnNpYmlsaXR5ID09PSAnQlJBTkQnKSB7XHJcbiAgICAgICAgICAvLyBHZXQgYnJhbmQgSUQgZnJvbSBwYXJ0XHJcbiAgICAgICAgICBjb25zdCBwYXJ0ID0gYXdhaXQgcHJpc21hLnBhcnQuZmluZFVuaXF1ZSh7XHJcbiAgICAgICAgICAgIHdoZXJlOiB7IGlkOiBwYXJ0SWQgfSxcclxuICAgICAgICAgICAgc2VsZWN0OiB7IGJyYW5kSWQ6IHRydWUgfVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICBpZiAoIXBhcnQpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdQYXJ0IG5vdCBmb3VuZCcgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBwYXllcklkID0gcGFydC5icmFuZElkO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY29zdFJlc3BvbnNpYmlsaXR5ID09PSAnU0VSVklDRV9DRU5URVInKSB7XHJcbiAgICAgICAgICBwYXllcklkID0gc2VydmljZUNlbnRlcklkO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ0N1c3RvbWVyIHBheW1lbnQgbm90IHN1cHBvcnRlZCBpbiB0aGlzIHZlcnNpb24nIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgd2FsbGV0IGJhbGFuY2VcclxuICAgICAgICBjb25zdCBiYWxhbmNlQ2hlY2sgPSBhd2FpdCBjaGVja0VuaGFuY2VkV2FsbGV0QmFsYW5jZShwYXllcklkLCBlc3RpbWF0ZWRDb3VyaWVyQ29zdCk7XHJcbiAgICAgICAgaWYgKCFiYWxhbmNlQ2hlY2sgfHwgIWJhbGFuY2VDaGVjay5zdWZmaWNpZW50KSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBcclxuICAgICAgICAgICAgZXJyb3I6ICdJbnN1ZmZpY2llbnQgd2FsbGV0IGJhbGFuY2UnLFxyXG4gICAgICAgICAgICByZXF1aXJlZDogZXN0aW1hdGVkQ291cmllckNvc3QsXHJcbiAgICAgICAgICAgIGF2YWlsYWJsZTogYmFsYW5jZUNoZWNrPy5jdXJyZW50QmFsYW5jZSB8fCAwLFxyXG4gICAgICAgICAgICBzaG9ydGZhbGw6IGJhbGFuY2VDaGVjaz8uc2hvcnRmYWxsIHx8IGVzdGltYXRlZENvdXJpZXJDb3N0XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IHJldmVyc2VSZXF1ZXN0ID0gYXdhaXQgcHJpc21hLnJldmVyc2VSZXF1ZXN0LmNyZWF0ZSh7XHJcbiAgICAgICAgZGF0YToge1xyXG4gICAgICAgICAgc2VydmljZUNlbnRlcklkLFxyXG4gICAgICAgICAgcGFydElkLFxyXG4gICAgICAgICAgcmVhc29uLFxyXG4gICAgICAgICAgcmV0dXJuUmVhc29uOiByZXR1cm5SZWFzb24gfHwgbnVsbCxcclxuICAgICAgICAgIGNvc3RSZXNwb25zaWJpbGl0eSxcclxuICAgICAgICAgIGNvdXJpZXJDb3N0OiBwcm9jZXNzUGF5bWVudCA/IGVzdGltYXRlZENvdXJpZXJDb3N0IDogbnVsbCxcclxuICAgICAgICAgIHF1YW50aXR5OiBxdWFudGl0eSB8fCAxLFxyXG4gICAgICAgICAgc3RhdHVzOiBzdGF0dXMgfHwgJ1JFUVVFU1RFRCcsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICBzZXJ2aWNlQ2VudGVyOiB0cnVlLFxyXG4gICAgICAgICAgcGFydDoge1xyXG4gICAgICAgICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgICAgICAgYnJhbmQ6IHRydWUsXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pXHJcblxyXG4gICAgICAvLyBQcm9jZXNzIHdhbGxldCBkZWR1Y3Rpb24gaWYgcmVxdWVzdGVkXHJcbiAgICAgIGlmIChwcm9jZXNzUGF5bWVudCkge1xyXG4gICAgICAgIHdhbGxldERlZHVjdGlvblJlc3VsdCA9IGF3YWl0IHByb2Nlc3NSZXR1cm5Db3VyaWVyQ29zdChcclxuICAgICAgICAgIHJldmVyc2VSZXF1ZXN0LmlkLFxyXG4gICAgICAgICAgZXN0aW1hdGVkQ291cmllckNvc3QsXHJcbiAgICAgICAgICBmYWxzZSAvLyBub3QgYWRtaW4gb3ZlcnJpZGVcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoIXdhbGxldERlZHVjdGlvblJlc3VsdC5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAvLyBSb2xsYmFjayB0aGUgcmV2ZXJzZSByZXF1ZXN0IGNyZWF0aW9uXHJcbiAgICAgICAgICBhd2FpdCBwcmlzbWEucmV2ZXJzZVJlcXVlc3QuZGVsZXRlKHtcclxuICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHJldmVyc2VSZXF1ZXN0LmlkIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgXHJcbiAgICAgICAgICAgIGVycm9yOiAnV2FsbGV0IGRlZHVjdGlvbiBmYWlsZWQnLFxyXG4gICAgICAgICAgICBkZXRhaWxzOiB3YWxsZXREZWR1Y3Rpb25SZXN1bHQuZXJyb3JcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmVzLnN0YXR1cygyMDEpLmpzb24oe1xyXG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgICAgcmV2ZXJzZVJlcXVlc3QsXHJcbiAgICAgICAgY29zdEluZm86IHtcclxuICAgICAgICAgIGNvc3RSZXNwb25zaWJpbGl0eSxcclxuICAgICAgICAgIGVzdGltYXRlZENvdXJpZXJDb3N0LFxyXG4gICAgICAgICAgbWVzc2FnZTogYENvdXJpZXIgY29zdCB3aWxsIGJlIGJvcm5lIGJ5OiAke2Nvc3RSZXNwb25zaWJpbGl0eS5yZXBsYWNlKCdfJywgJyAnKX1gLFxyXG4gICAgICAgICAgd2FsbGV0RGVkdWN0ZWQ6IHByb2Nlc3NQYXltZW50LFxyXG4gICAgICAgICAgd2FsbGV0UmVzdWx0OiB3YWxsZXREZWR1Y3Rpb25SZXN1bHRcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjcmVhdGluZyByZXZlcnNlIHJlcXVlc3Q6JywgZXJyb3IpXHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdGYWlsZWQgdG8gY3JlYXRlIHJldmVyc2UgcmVxdWVzdCcgfSlcclxuICAgIH1cclxuICB9IGVsc2UgaWYgKHJlcS5tZXRob2QgPT09ICdQVVQnKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB7IGlkLCBzdGF0dXMsIGF3Yk51bWJlciwgY291cmllckNvc3QsIHBhaWRCeSB9ID0gcmVxLmJvZHlcclxuICAgICAgXHJcbiAgICAgIGlmICghaWQpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1JlcXVlc3QgSUQgaXMgcmVxdWlyZWQnIH0pXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHVwZGF0ZURhdGE6IGFueSA9IHt9XHJcbiAgICAgIGlmIChzdGF0dXMpIHVwZGF0ZURhdGEuc3RhdHVzID0gc3RhdHVzXHJcbiAgICAgIGlmIChhd2JOdW1iZXIpIHVwZGF0ZURhdGEuYXdiTnVtYmVyID0gYXdiTnVtYmVyXHJcbiAgICAgIGlmIChjb3VyaWVyQ29zdCAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmNvdXJpZXJDb3N0ID0gY291cmllckNvc3RcclxuICAgICAgaWYgKHBhaWRCeSkgdXBkYXRlRGF0YS5wYWlkQnkgPSBwYWlkQnlcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHJldmVyc2VSZXF1ZXN0ID0gYXdhaXQgcHJpc21hLnJldmVyc2VSZXF1ZXN0LnVwZGF0ZSh7XHJcbiAgICAgICAgd2hlcmU6IHsgaWQgfSxcclxuICAgICAgICBkYXRhOiB1cGRhdGVEYXRhLFxyXG4gICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgIHNlcnZpY2VDZW50ZXI6IHRydWUsXHJcbiAgICAgICAgICBwYXJ0OiB7XHJcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcclxuICAgICAgICAgICAgICBicmFuZDogdHJ1ZSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSlcclxuICAgICAgXHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJldmVyc2VSZXF1ZXN0KVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdXBkYXRpbmcgcmV2ZXJzZSByZXF1ZXN0OicsIGVycm9yKVxyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnRmFpbGVkIHRvIHVwZGF0ZSByZXZlcnNlIHJlcXVlc3QnIH0pXHJcbiAgICB9XHJcbiAgfSBlbHNlIHtcclxuICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydHRVQnLCAnUE9TVCcsICdQVVQnXSlcclxuICAgIHJlcy5zdGF0dXMoNDA1KS5lbmQoYE1ldGhvZCAke3JlcS5tZXRob2R9IE5vdCBBbGxvd2VkYClcclxuICB9XHJcbn0iXSwibmFtZXMiOlsicHJpc21hIiwicHJvY2Vzc1JldHVybkNvdXJpZXJDb3N0IiwiY2hlY2tFbmhhbmNlZFdhbGxldEJhbGFuY2UiLCJkZXRlcm1pbmVSZXR1cm5Db3N0UmVzcG9uc2liaWxpdHkiLCJyZXR1cm5SZWFzb24iLCJlc3RpbWF0ZVJldHVybkNvdXJpZXJDb3N0Iiwid2VpZ2h0IiwiZG9ja2V0Q2hhcmdlIiwicGVyS2dDaGFyZ2UiLCJNYXRoIiwiY2VpbCIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJicmFuZElkIiwic2VydmljZUNlbnRlcklkIiwicXVlcnkiLCJ3aGVyZUNsYXVzZSIsInBhcnQiLCJyZXZlcnNlUmVxdWVzdHMiLCJyZXZlcnNlUmVxdWVzdCIsImZpbmRNYW55Iiwid2hlcmUiLCJpbmNsdWRlIiwic2VydmljZUNlbnRlciIsImJyYW5kIiwib3JkZXJCeSIsImNyZWF0ZWRBdCIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJwYXJ0SWQiLCJyZWFzb24iLCJxdWFudGl0eSIsInByb2Nlc3NQYXltZW50IiwiYm9keSIsImNvc3RSZXNwb25zaWJpbGl0eSIsImVzdGltYXRlZENvdXJpZXJDb3N0Iiwid2FsbGV0RGVkdWN0aW9uUmVzdWx0IiwicGF5ZXJJZCIsImZpbmRVbmlxdWUiLCJpZCIsInNlbGVjdCIsImJhbGFuY2VDaGVjayIsInN1ZmZpY2llbnQiLCJyZXF1aXJlZCIsImF2YWlsYWJsZSIsImN1cnJlbnRCYWxhbmNlIiwic2hvcnRmYWxsIiwiY3JlYXRlIiwiZGF0YSIsImNvdXJpZXJDb3N0Iiwic3VjY2VzcyIsImRlbGV0ZSIsImRldGFpbHMiLCJjb3N0SW5mbyIsIm1lc3NhZ2UiLCJyZXBsYWNlIiwid2FsbGV0RGVkdWN0ZWQiLCJ3YWxsZXRSZXN1bHQiLCJhd2JOdW1iZXIiLCJwYWlkQnkiLCJ1cGRhdGVEYXRhIiwidW5kZWZpbmVkIiwidXBkYXRlIiwic2V0SGVhZGVyIiwiZW5kIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/reverse-requests.ts\n')}};var __webpack_require__=require("../../webpack-api-runtime.js");__webpack_require__.C(exports);var __webpack_exec__=c=>__webpack_require__(__webpack_require__.s=c),__webpack_exports__=__webpack_require__.X(0,["vendor-chunks/next"],()=>__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Freverse-requests&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5Creverse-requests.ts&middlewareConfigBase64=e30%3D!"));module.exports=__webpack_exports__})();